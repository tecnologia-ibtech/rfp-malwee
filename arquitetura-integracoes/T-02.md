---
layout: topic
---


## T-02 - Fonte da Verdade (Master Data)

### Pergunta
Em sua arquitetura proposta (T-01), qual componente será a "fonte da verdade" (Master Data) durante a navegação (Preço, Estoque)? A própria plataforma? Um MDM? Um Middleware/Gateway?

### Resposta

Na arquitetura Geovendas, a "fonte da verdade" é estrategicamente distribuída entre componentes especializados, cada um responsável por diferentes tipos de dados, garantindo performance otimizada, consistência e autonomia operacional. Esta abordagem reconhece que diferentes tipos de dados possuem diferentes requisitos de latência, consistência e disponibilidade.

#### Fonte da Verdade para Dados Mestres Estruturais

Para dados mestres estruturais e relativamente estáticos como cadastros de clientes, catálogo de produtos, atributos técnicos e classificações, a fonte primária da verdade permanece sendo o sistema ERP corporativo. O SAP mantém o registro autoritativo destes dados, pois eles fazem parte do core corporativo e são utilizados por múltiplos sistemas além da plataforma B2B. Entretanto, a plataforma Geovendas não consulta o ERP diretamente a cada operação.

Em vez disso, a plataforma mantém uma réplica sincronizada e enriquecida destes dados mestres em sua própria base de dados. Esta réplica não é uma simples cópia, mas sim uma representação otimizada e estendida que inclui atributos adicionais específicos do canal digital que não existem no ERP. Por exemplo, enquanto o SAP pode armazenar informações básicas de um produto, a plataforma Geovendas adiciona metadados como ordem de exibição no catálogo, relacionamentos entre produtos, tags de busca otimizadas, imagens e mídias, descrições marketing-oriented e configurações de visualização por perfil de cliente.

#### Fonte da Verdade para Preços Durante Navegação

Durante a navegação no portal B2B, a plataforma Geovendas atua como fonte da verdade para preços. As tabelas de preços são sincronizadas do ERP para a base de dados da plataforma, onde são indexadas e otimizadas para consulta de alta performance. Esta arquitetura é fundamental para garantir experiência de usuário fluida, pois permite que milhares de preços sejam consultados em milissegundos durante a navegação do catálogo, sem sobrecarregar o ERP com requisições desnecessárias.

A plataforma também implementa um mecanismo sofisticado de cálculo de preços que considera múltiplas variáveis além da tabela base: condições especiais do cliente, campanhas promocionais ativas, políticas de desconto progressivo por volume, preços diferenciados por região geográfica, e regras de negociação customizadas. Estes cálculos são realizados em tempo real durante a navegação, utilizando engines de regras de negócio que operam sobre os dados mestres locais.

Um aspecto crucial é que, embora a plataforma seja a fonte da verdade durante a navegação, existe um processo de validação adicional no momento da finalização do pedido. Neste ponto, os preços e condições são recalculados utilizando as regras mais atualizadas e podem ser opcionalmente validados contra o ERP antes da confirmação final, garantindo que eventuais alterações de última hora sejam consideradas.

#### Fonte da Verdade para Estoque em Tempo Real

Para informações de estoque disponível, a arquitetura implementa um modelo de cache distribuído que atua como fonte da verdade operacional durante a navegação. O estoque do ERP é continuamente sincronizado para um sistema de cache em memória de alta performance, que permite consultas extremamente rápidas sem impactar o ERP. Esta camada de cache é atualizada em intervalos configuráveis (tipicamente a cada poucos minutos) ou através de eventos push quando o ERP suporta notificações de mudança de estoque.

Durante a navegação, quando um representante ou cliente consulta a disponibilidade de um produto, a resposta vem imediatamente do cache local. Isso proporciona experiência de usuário superior, com tempos de resposta da ordem de milissegundos. O cache mantém não apenas o estoque bruto, mas também informações derivadas como estoque disponível para venda (descontando reservas), estoque previsto considerando pedidos em trânsito, e projeções de disponibilidade futura baseadas em históricos de reposição.

No momento crítico de adição de itens ao carrinho e finalização do pedido, a arquitetura implementa um mecanismo de reserva soft que marca aquela quantidade como comprometida, evitando overselling. Esta reserva é temporária e expira após um período configurável caso o pedido não seja finalizado. Quando o pedido é efetivamente confirmado, a reserva soft é convertida em reserva definitiva que é sincronizada com o ERP.

#### Papel do Sistema de Back-Office como Orquestrador

O sistema de back-office da plataforma Geovendas funciona como um hub orquestrador que gerencia a governança dos dados mestres. Ele não substitui o ERP como fonte primária, mas atua como camada de enriquecimento e controle. Administradores podem visualizar quais dados estão sincronizados, forçar atualizações quando necessário, configurar regras de negócio que estendem as funcionalidades base do ERP, e resolver manualmente eventuais conflitos de sincronização.

Este back-office também mantém dados mestres que são específicos do canal digital e não existem no ERP, como configurações de exibição do portal, políticas de acesso e visualização de catálogo por perfil de usuário, campanhas e banners promocionais, regras de cross-sell e up-sell, e conteúdos educacionais sobre produtos. Para estes dados, o back-office é a fonte autoritativa e única.

#### Estratégia de Consistência Eventual

A arquitetura reconhece e abraça o conceito de consistência eventual para otimizar performance. Durante a navegação, os usuários visualizam dados que podem ter alguns minutos de defasagem em relação ao ERP, o que é aceitável para a experiência de usuário. Entretanto, em pontos críticos como fechamento de pedido, validações em tempo real garantem consistência forte quando necessário.

Esta abordagem híbrida de fonte da verdade - onde o ERP é a fonte autoritativa mas a plataforma mantém réplicas otimizadas para operação - proporciona o melhor equilíbrio entre autonomia operacional, performance de navegação, e integridade dos dados corporativos. Dashboards de monitoramento permitem que a equipe de TI acompanhe a saúde das sincronizações e identifique rapidamente qualquer divergência que necessite atenção.
