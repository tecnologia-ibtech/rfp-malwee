---
layout: topic
---

## T-29 - Segregação de Acessos Privilegiados

### Pergunta
Existe política de controle e segregação de acessos privilegiados (princípio do menor privilégio)?

### Resposta

A gestão rigorosa de acessos privilegiados constitui controle de segurança crítico, já que contas com privilégios elevados representam alvos de alto valor para atacantes e riscos significativos quando comprometidas. O princípio de menor privilégio estabelece que usuários devem possuir apenas permissões mínimas necessárias para realizar suas funções legítimas, reduzindo superfície de ataque e limitando impacto potencial de comprometimento.

#### Identificação e Classificação de Acessos Privilegiados

Acessos privilegiados incluem contas administrativas de sistemas operacionais, administradores de banco de dados, contas de serviço com permissões elevadas e usuários com capacidade de modificar configurações críticas de aplicação. Cada categoria de acesso privilegiado apresenta riscos específicos e requer controles apropriados.

Contas administrativas de infraestrutura possuem capacidade de modificar configurações de sistema, instalar software, acessar arquivos de outros usuários e potencialmente comprometer integridade de todo ambiente. Estas contas são alvos primários de atacantes que buscam estabelecer persistência e expandir acesso através de escalação de privilégios.

Administradores de banco de dados têm acesso direto a dados sensíveis, capacidade de modificar estruturas de dados, criar backups e potencialmente exfiltrar informações confidenciais. O controle destes acessos é fundamental para proteção de dados e conformidade com regulamentações de privacidade.

Contas de serviço utilizadas por aplicações para comunicação entre componentes frequentemente operam com privilégios elevados para realizar funções necessárias. Estas contas apresentam risco específico porque credenciais podem estar armazenadas em arquivos de configuração ou código, potencialmente expostas a desenvolvedores ou atacantes que comprometam sistemas.

#### Implementação de Controles de Menor Privilégio

A aplicação de princípio de menor privilégio inicia com análise detalhada de funções de cada usuário e determinação de permissões mínimas necessárias. Esta análise considera não apenas atividades rotineiras, mas também tarefas ocasionais que podem requerer permissões adicionais temporárias.

Perfis de acesso padronizados para funções comuns facilitam aplicação consistente de menor privilégio. Ao invés de configuração ad-hoc de permissões para cada usuário individual, perfis predefinidos para desenvolvedor, administrador de sistema, usuário de negócio garantem aplicação sistemática de controles apropriados.

A segregação de funções administrativas previne concentração excessiva de poder em contas individuais. Separação entre administradores de sistema e administradores de banco de dados, entre administradores de produção e desenvolvimento, entre capacidades de aprovação e execução implementa checks and balances que reduzem risco de abuso ou erro.

Mecanismos de elevação temporária de privilégios (sudo, runas, jump servers) permitem execução de operações privilegiadas sem manutenção de acessos elevados permanentes. Usuários operam com permissões limitadas na maioria do tempo, elevando privilégios apenas quando necessário para tarefas específicas.

#### Estado Atual de Gestão de Privilégios

A plataforma implementa controles de acesso baseados em perfis de usuário que diferenciam capacidades conforme função. Administradores de sistema possuem acesso a configurações de infraestrutura e aplicação não disponíveis a usuários operacionais. Esta diferenciação implementa forma básica de segregação de privilégios.

Contas de serviço utilizadas pela aplicação para acesso a bancos de dados e outros recursos são configuradas com permissões específicas necessárias para operação, evitando utilização de contas administrativas genéricas. Esta prática reduz escopo de acesso disponível caso credenciais de serviço sejam comprometidas.

A separação entre ambientes de desenvolvimento, teste e produção implementa forma de segregação onde desenvolvedores têm acesso completo a ambientes não-produtivos mas acesso limitado ou nenhum a sistemas de produção. Esta separação reduz risco de modificações acidentais ou maliciosas em dados produtivos.

#### Limitações em Controles de Privilégios Avançados

A implementação de ferramentas especializadas de gestão de acessos privilegiados (PAM - Privileged Access Management) que fornecem funcionalidades como checkout/checkin de credenciais, sessões gravadas, aprovação de acesso e rotação automática de senhas pode não estar completamente estabelecida.

Just-in-time access que concede privilégios elevados apenas durante janelas temporais específicas e para tarefas aprovadas representa evolução em controles de privilégio que minimiza janela de exposição. Este modelo requer infraestrutura de aprovação e automação que pode não estar implementada.

Monitoramento especializado de atividades privilegiadas através de análise comportamental que detecta utilizações anômalas de contas administrativas - acessos em horários incomuns, operações atípicas, padrões suspeitos - fornece detecção proativa de comprometimento ou abuso.

#### Controles de Autenticação para Acessos Privilegiados

Acessos privilegiados devem ter requisitos de autenticação mais rigorosos que contas de usuário regular. Autenticação multifator para todas as contas administrativas adiciona camada significativa de proteção contra comprometimento de credenciais através de ataques de phishing, keylogging ou vazamentos de senha.

Estações de trabalho administrativas dedicadas, separadas de sistemas utilizados para atividades diárias como email e navegação web, reduzem exposição a malware e ataques de drive-by download que frequentemente comprometem estações de usuários regulares. Estas estações podem ter configurações de segurança mais restritivas apropriadas para atividades administrativas.

Protocolos seguros de acesso remoto para atividades administrativas, incluindo VPNs robustas, jump servers ou bastion hosts, garantem que acessos privilegiados de localizações externas passem por controles de segurança apropriados. Acesso administrativo direto da internet apresenta riscos elevados que requerem proteção especial.

#### Auditoria e Monitoramento de Privilégios

Logs detalhados de todas atividades realizadas com contas privilegiadas fornecem trilha de auditoria essencial para investigação de incidentes, demonstração de conformidade e detecção de abusos. Estes logs devem incluir não apenas comandos executados, mas contexto como horário, localização de origem e justificativa quando disponível.

Revisões periódicas de acessos privilegiados verificam se permissões continuam apropriadas para funções atuais de usuários. Funcionários que mudaram de função podem reter acessos desnecessários. Funcionários que deixaram organização devem ter acessos imediatamente revogados para prevenir utilização não autorizada.

Alertas automáticos para atividades privilegiadas suspeitas - múltiplas falhas de autenticação, acessos em horários anômalos, execução de comandos perigosos, modificações de configurações críticas - permitem resposta rápida a potencial comprometimento ou abuso.

#### Gestão de Contas de Serviço

Contas de serviço apresentam desafios específicos de gestão porque não são associadas a indivíduos humanos mas a processos automatizados. A rotação regular de credenciais de contas de serviço é essencial mas pode ser complexa quando múltiplas aplicações dependem das mesmas credenciais.

A utilização de autenticação baseada em certificados ou tokens para contas de serviço, ao invés de senhas estáticas, fornece segurança superior. Certificados podem ter validade limitada e ser rotacionados automaticamente sem intervenção manual.

Monitoramento de utilização de contas de serviço para detectar acessos de localizações inesperadas ou execução de atividades atípicas pode identificar comprometimento. Contas de serviço têm padrões de utilização mais previsíveis que contas humanas, facilitando detecção de anomalias.