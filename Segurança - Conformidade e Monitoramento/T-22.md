
## T-22 - Logs de Segurança

### Pergunta
Logs de segurança são coletados e armazenados pelo período necessário?

### Resposta

A coleta, armazenamento e análise de logs de segurança constituem capacidade fundamental de detecção de incidentes, investigação forense, demonstração de conformidade e auditoria de atividades em ambientes tecnológicos. Logs fornecem registros cronológicos de eventos que permitem reconstrução de sequências de ações, identificação de comportamentos anômalos e responsabilização de atividades realizadas.

#### Categorias de Eventos Registrados em Logs

Logs de autenticação registram tentativas de login bem-sucedidas e falhadas, incluindo identificação de usuário, timestamp, endereço IP de origem e resultado da tentativa. Estes logs são fundamentais para detecção de ataques de força bruta, identificação de acessos de localizações anômalas e investigação de comprometimento de credenciais.

Logs de autorização documentam tentativas de acesso a recursos ou execução de operações, incluindo acessos bem-sucedidos e tentativas negadas por ausência de permissões. Padrões de tentativas frequentes de acesso não autorizado podem indicar reconhecimento por atacante ou usuário interno tentando exceder suas permissões.

Logs de modificação de dados registram operações de criação, atualização e exclusão de informações sensíveis, incluindo identificação de usuário responsável, timestamp, dados modificados (antes e depois quando apropriado) e contexto da operação. Estes logs são essenciais para auditoria de conformidade, investigação de modificações não autorizadas ou acidentais, e potencial recuperação de dados.

Logs de sistema registram eventos de infraestrutura - inicializações e desligamentos de serviços, erros de aplicação, alertas de recursos, modificações de configuração. Estes logs fornecem contexto técnico essencial para diagnóstico de problemas operacionais e investigação de incidentes de segurança.

Logs de rede capturam informações sobre conexões, fluxos de dados, requisições HTTP, queries DNS e outros eventos de comunicação. Em ambientes com monitoramento de rede avançado, estes logs identificam comunicações com endereços maliciosos conhecidos, exfiltração de dados através de padrões anômalos de tráfego, ou scanning de rede por atacantes.

#### Infraestrutura de Logging Implementada

A plataforma implementa logging de eventos relevantes através de frameworks de logging estruturados. Eventos de autenticação, operações transacionais importantes, erros de aplicação e eventos de sistema são registrados com informações contextuais apropriadas incluindo timestamps precisos, identificação de usuários, endereços IP de origem e detalhes específicos de cada tipo de evento.

Os logs são armazenados de forma persistente, protegendo contra perda de informações por falhas temporárias de sistemas ou reinicializações. A rotação automática de arquivos de log previne crescimento ilimitado, com arquivos mais antigos sendo arquivados ou removidos conforme políticas de retenção.

A estruturação de logs em formato processável por máquinas facilita análise automatizada e correlação de eventos. Formatos estruturados como JSON permitem extração eficiente de campos específicos, filtragem, agregação e análise através de ferramentas especializadas de gestão de logs.

#### Períodos de Retenção de Logs

Os períodos de retenção de logs balanceiam múltiplas considerações. Requisitos legais e regulatórios podem estabelecer períodos mínimos de retenção para categorias específicas de logs. Legislações fiscais e comerciais frequentemente exigem manutenção de registros transacionais por anos. Regulamentações de proteção de dados podem estabelecer períodos máximos além dos quais dados pessoais não devem ser retidos sem justificativa específica.

Necessidades de investigação de incidentes de segurança influenciam períodos de retenção. Incidentes sofisticados podem não ser detectados imediatamente, com atacantes mantendo acesso por meses antes de detecção. Logs que cobrem períodos longos permitem investigação retrospectiva completa, identificando momento de comprometimento inicial e todas atividades subsequentes.

Capacidade de armazenamento disponível e custos associados constituem considerações práticas. Logs detalhados de ambientes de alto volume podem gerar terabytes de dados mensalmente. Estratégias de retenção podem incluir período mais curto para logs completos e detalhados, com agregação e retenção mais longa de logs sumarizados ou amostrados.

Práticas comuns incluem retenção de logs online (imediatamente acessíveis para análise) por períodos como 90 dias, com arquivamento para armazenamento de menor custo por períodos mais longos (1-7 anos conforme requisitos). Logs arquivados podem requerer processos de restauração antes de análise, mas permitem investigações de eventos históricos quando necessário.

#### Proteção e Integridade de Logs

Logs de segurança são alvos atrativos para atacantes que buscam eliminar evidências de suas atividades. Controles apropriados protegem logs contra modificação ou exclusão não autorizada. Permissões restritivas garantem que apenas processos de sistema e administradores autorizados podem gravar logs, enquanto modificação ou exclusão de logs existentes é extremamente restrita ou impossível.

A transmissão de logs para sistemas centralizados de gestão de logs, separados de sistemas geradores, protege contra cenários onde comprometimento de servidor permite atacante eliminar logs locais. Replicação de logs para múltiplas localizações aumenta resiliência contra perda.

Mecanismos de verificação de integridade, como assinaturas digitais ou hashes criptográficos de arquivos de log, permitem detecção de modificações não autorizadas. Em ambientes de alta segurança, write-once media ou blockchain podem ser utilizados para garantia criptográfica de imutabilidade de logs.

A proteção de confidencialidade de logs é essencial, especialmente quando contêm informações sensíveis. Controles de acesso restritivos limitam visualização de logs a pessoal autorizado. Em casos onde logs precisam ser compartilhados com terceiros (como durante investigações de incidentes), redação de informações sensíveis preserva privacidade enquanto mantém utilidade investigativa.

#### Análise e Monitoramento de Logs

A coleta de logs, por si só, tem valor limitado se logs não são analisados ativamente. Monitoramento contínuo de logs através de sistemas de SIEM (Security Information and Event Management) ou ferramentas de análise de logs identifica padrões indicativos de problemas de segurança ou operacionais em tempo real ou próximo de tempo real.

Alertas automatizados configurados para eventos específicos - múltiplas falhas de autenticação, acessos de IPs suspeitos, modificações de configurações críticas, erros que indicam tentativas de exploração - notificam equipes de segurança imediatamente, permitindo resposta rápida. A sintonia apropriada de alertas evita fadiga por excesso de falsos positivos enquanto captura eventos genuinamente suspeitos.

Análise de correlação identifica padrões complexos distribuídos através de múltiplos eventos e sistemas. Ataques sofisticados frequentemente deixam rastros fragmentados que apenas são reconhecidos através de correlação de eventos aparentemente desconexos. Regras de correlação detectam sequências de eventos que individualmente parecem inócuos mas coletivamente indicam comprometimento.

Análises periódicas de logs, mesmo quando incidentes não são suspeitados, fornecem insights sobre padrões de utilização, tendências ao longo do tempo e anomalias que merecem investigação. Revisões regulares de logs de acesso administrativo garantem accountability e detectam abusos de privilégio.

#### Logs como Evidência e Conformidade

Em investigações forenses ou processos legais, logs constituem evidência crítica. A admissibilidade de logs como evidência depende de demonstração de confiabilidade - que logs não foram modificados, que timestamps são precisos, que processos de coleta preservam integridade. Práticas apropriadas de gestão de logs, incluindo proteção de integridade e cadeia de custódia documentada, são essenciais para utilização legal.

Auditorias de conformidade frequentemente requerem demonstração de logging apropriado e retenção de logs. Regulamentações específicas estabelecem requisitos sobre quais eventos devem ser registrados, por quanto tempo logs devem ser retidos e controles para proteção de integridade. A ausência de logs adequados pode constituir não-conformidade mesmo na ausência de outros problemas.

A demonstração através de logs de que controles de acesso são efetivos, que tentativas de acesso não autorizado são detectadas e bloqueadas, que atividades administrativas são rastreadas, fornece evidência objetiva de postura de segurança para stakeholders diversos - clientes, auditores, reguladores, seguradoras.

#### Considerações de Privacidade em Logging

Enquanto logging abrangente é desejável para segurança, coleta de dados pessoais em logs deve considerar princípios de proteção de dados. O logging deve ser limitado ao necessário para finalidades legítimas de segurança, detecção de fraude e auditoria. Informações pessoais desnecessárias não devem ser registradas simplesmente porque tecnicamente possível.

Logs contendo dados pessoais devem ser protegidos conforme sensibilidade das informações. Logs de autenticação contendo endereços IP são menos sensíveis que logs contendo informações transacionais detalhadas ou comunicações entre usuários. A classificação de logs conforme sensibilidade informa controles apropriados de proteção e períodos de retenção.

Direitos de titulares de dados, incluindo acesso a informações sobre tratamento de seus dados pessoais, podem estender-se a logs. Solicitações de acesso podem requerer fornecimento de registros de logs relacionados a indivíduo específico. A capacidade de buscar logs por identificação de titular facilita atendimento a estas solicitações.